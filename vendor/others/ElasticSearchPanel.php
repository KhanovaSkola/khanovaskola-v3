<?php

namespace Mikulas\Diagnostics;

use Elasticsearch\Client;
use Nette;


class ElasticSearchPanel extends Nette\Object implements \Nette\Diagnostics\IBarPanel
{

	/** @var array */
	private $queries = [];

	public function onSearch(array $res, array $params)
	{
		unset($res['hits']['hits']);
		$this->queries[] = [$res, $params];
	}

	/**
	 * Renders HTML code for custom tab.
	 * @return string
	 */
	public function getTab()
	{
		return '<span title="ElasticSearch">'
		. '<img width="16" height="16" title="" alt="" src="data:image/png;base64,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" />'
		. $this->getTitle()
		. '</span>';
	}

	private function getTitle()
	{
		$total = 0;
		foreach ($this->queries as $pair)
		{
			list($query, $params) = $pair;
			$total += $query['took'];
		}

		$c = count($this->queries);
		return ($c === 0
			? 'no queries'
			: ($c === 1
				? '1 query'
				: "$c queries"
		))
		. " / {$total}ms";
	}

	/**
	 * Renders HTML code for custom panel.
	 * @return string
	 */
	public function getPanel()
	{
		$s = '';
		$depth = Nette\Diagnostics\Debugger::$maxDepth;
		Nette\Diagnostics\Debugger::$maxDepth = 20;
		foreach ($this->queries as $pair)
		{
			list($query, $params) = $pair;

			$s .= '<tr><td>'
				. $query['took']
				. '</td><td>'
				. Nette\Diagnostics\Debugger::dump($params['body'], $return = TRUE)
				. '</td><td>'
				. $query['hits']['total']
				. '</td><tr>';
		}

		Nette\Diagnostics\Debugger::$maxDepth = $depth;
		return '
			<h1>' . $this->getTitle() . '</h1>
			<div class="nette-inner">
				<table>
					<tr><th>Time&nbsp;ms</th><th>Query</th><th>Hits</th></tr>' . $s . '
				</table>
			</div>';
	}

}
